var aiCorrectAgeYear,aiCorrectAgeMonth,aiFinalAge,aiAgeYears_str,aiAgeMonths_str,actualCommandObj,greeting,micPermission,listening,attention=!0,_userData=localStorage["user-data"],_brain=localStorage.brain,actualInput=document.querySelector("#user-input"),userSubmitedText=document.querySelector("#user-submited-text"),sophiaReply=document.querySelector("#sophia-reply"),speakingLog=document.querySelector("#speaking-log"),ai={name:"Sophia",age:void 0,gender:"feminino",article:"a",version:"v4.0",author:"Victor Ribeiro",
mood:10,happiness:10,angry:0,say:function(a){document.querySelector("#sophia-reply").innerHTML=a;voice();bootstrap.title.animation("fadeInUp","fadeOut");bootstrap.title.text('<span class="title_Med"'+a+"</span>")},listening:function(a){switch(a){case !0:listening=!0;$("#voice-recognition").attr("title","Estou ouvindo").css({"background-image":"url(img/icons/ionicons/ios7-mic.png)","background-color":"#3de5f3"}).removeClass().addClass("voice-recognition-listening");intScr_nameInput.setAttribute("placeholder",
"Fale ou digite-o aqui");break;case !1:listening=!1;$("#voice-recognition").attr("title","N\u00e3o consigo ouvir").css({"background-image":"url(img/icons/ionicons/ios7-mic-off.png)","background-color":"#ff5b5b"}).removeClass().addClass("voice-recognition-notlistening");intScr_nameInput.setAttribute("placeholder","Digite-o aqui");break;default:listening=!0,$("#voice-recognition").attr("title","Estou ouvindo mas n\u00e3o tem minha aten\u00e7\u00e3o").css({"background-image":"url(img/icons/ionicons/ios7-mic.png)",
"background-color":"#fff25b"}).removeClass().addClass("voice-recognition-halflistening"),intScr_nameInput.setAttribute("placeholder","Fale ou digite-o aqui")}},attention:{off:function(){void 0!==voicePlaying&&voicePlaying?(attention=!1,changeCommands(noAttentionCommands),console.log("nenhuma fala detectada"),console.log("prestando aten\u00e7\u00e3o: n\u00e3o"),console.log("ouvindo: n\u00e3o"),ai.listening(!1)):(attention=!1,changeCommands(noAttentionCommands),console.log("prestando aten\u00e7\u00e3o: n\u00e3o"),
ai.listening(!1),notification.create("","Se precisar de algo \u00e9 s\u00f3 chamar.","img/icons/ionicons/ios7-mic.png",5E3))},on:function(){attention=!0;changeCommands(defaultCommands);console.log("ouvindo: sim");notification.create("success","Minha aten\u00e7\u00e3o \u00e9 sua.","img/icons/ionicons/ios7-mic.png",5E3)}},animation:function(a,c,b){$(sophiaReply).removeClass().hide().show().removeClass("animated "+b).addClass("animated "+c).html(a)},network:function(a){switch(a){case !0:$("#network-connection").attr("title",
"Conex\u00e3o normal").css({"background-image":"url(img/icons/windows/appbar.network.png)","background-color":"#3de5f3"}).removeClass("network-connection-working network-connection-notworking").addClass("network-connection-working");break;case !1:ai.listening(!1),$("#network-connection").attr("title","Conex\u00e3o com problemas").css({"background-image":"url(img/icons/windows/appbar.network.disconnect.png)","background-color":"#ff5b5b"}).removeClass("network-connection-working network-connection-notworking").addClass("network-connection-notworking")}},
learning:{sinonimo:[],abra:{twitter:function(){window.open("https://www.google.com/search?q=twitter&btnI=")}},aprenda:{isso:function(){changeCommands(learnCommands);notification.create("","Modo aprendizado","",5E3)},"":function(){changeCommands(learnCommands);notification.create("","Modo aprendizado","",5E3);console.log("modo aprendizado")}}},action:function(a){var c=/(fale|diga|pesquise|pesquisa|pesquisar|fa\u00e7a|abra|abrir|abre|lembra|lembrar|me lembra|lembre-me|posta|postar|poste|aprende|aprenda|aprender)(| )(.*)/gi,
b=c.exec(a);if(a.match(c))if(console.log('Ordem: "'+b[1]+'"\nObjeto: "'+b[3]+'"'),actualOrder=b[1],actualObject=b[3].match(/^\s.*/gi)?b[3]=b[3].replace(/^\s(.*)/gi,"$1"):b[3]="",ai.learning.hasOwnProperty(actualOrder)&&ai.learning[actualOrder].hasOwnProperty(actualObject))ai.learning[actualOrder][actualObject]();else if(ai.learning.hasOwnProperty(actualOrder)&&ai.learning[actualOrder].hasOwnProperty(""))ai.learning[actualOrder][""]();else notification.create("error","Ainda n\u00e3o sei fazer isso.",
"",5E3);else console.log("falhou miseravelmente")}},dialog=window.localStorage.getItem("historico"),browserName=navigator.userAgent,now=new Date,sec=now.getSeconds(),min=now.getMinutes(),hour=now.getHours(),d=now.getDate(),w=now.getDay(),weekName="Domingo Segunda Ter\u00e7a Quarta Quinta Sexta S\u00e1bado".split(" "),week=weekName[w],m=now.getMonth(),monthNumbers="01 02 03 04 05 06 07 08 09 10 11 12".split(" "),monthNames="Janeiro Fevereiro Mar\u00e7o Abril Maio Junho Julho Agosto Setembro Outubro Novembro Dezembro".split(" "),
monthNumber=monthNumbers[m],monthName=monthNames[m],y=now.getFullYear(),aiBirth=new Date(2015,8,24,21,1,46),aiBirthYear=aiBirth.getFullYear(),aiBirthMonth=aiBirth.getMonth(),aiBirthDay=aiBirth.getDate(),aiAgeYears=fixYear(),aiAgeMonths=fixMonth(),aiYearsStr=["ano","anos"],aiMonthsStr=["m\u00eas","meses"];tmp_secStr=sec.toString();tmp_minStr=min.toString();tmp_hourStr=hour.toString();tmp_dayStr=d.toString();1===tmp_secStr.length&&(sec="0"+sec);1===tmp_minStr.length&&(min="0"+min);
1===tmp_hourStr.length&&(hour="0"+hour);1===tmp_dayStr.length&&(d="0"+d);aiAgeYears_str=1===aiAgeYears?aiYearsStr[0]:aiYearsStr[1];aiAgeMonths_str=1===aiAgeMonths?aiMonthsStr[0]:aiMonthsStr[1];ai.age=sophiaAge();_userData&&(user=JSON.parse(_userData));function fixYear(){aiCorrectAgeYear=y-aiBirthYear;d<aiBirthDay&&m===aiBirthMonth&&aiCorrectAgeYear--;return aiCorrectAgeYear}
function fixMonth(){if(m===aiBirthMonth&&d>=aiBirthDay)return aiCorrectAgeMonth=0;if(m>aiBirthMonth&&d<aiBirthDay)return aiCorrectAgeMonth=m-aiBirthMonth-1;if(m===aiBirthMonth&&d<aiBirthDay)return aiCorrectAgeMonth=11;if(m>aiBirthMonth&&d>=aiBirthDay)return aiCorrectAgeMonth=m-aiBirthMonth}
function sophiaAge(){return aiFinalAge=1<=aiAgeYears&&0<aiAgeMonths?aiAgeYears+" "+aiAgeYears_str+" e "+aiAgeMonths+" "+aiAgeMonths_str:1<=aiAgeYears&&0===aiAgeMonths?aiAgeYears+" "+aiAgeYears_str:aiAgeMonths+" "+aiAgeMonths_str}function capitalize(a){return a=a.substr(0,1).toUpperCase()+a.substr(1).toLowerCase()}function capitalize_s(a){return a=a.substr(0,1).toUpperCase()+a.substr(1)}
actualInput.addEventListener("keydown",function(){if(""!==actualInput.value&&13===event.keyCode)return rotina(),!1});
function changeCommands(a){switch(a){case defaultCommands:annyang.removeCommands();annyang.addCommands(defaultCommands);actualCommandObj=defaultCommands;console.log('Changed to "defaultCommands"');break;case noAttentionCommands:annyang.removeCommands();annyang.addCommands(noAttentionCommands);actualCommandObj=noAttentionCommands;console.log('Changed to "noAttentionCommands"');break;case learnCommands:annyang.removeCommands();annyang.addCommands(learnCommands);actualCommandObj=learnCommands;console.log('Changed to "learnCommands"');
break;case nameInputCommands:annyang.removeCommands();annyang.addCommands(nameInputCommands);actualCommandObj=nameInputCommands;console.log('Changed to "nameInputCommands"');break;case genderInputCommands:annyang.removeCommands();annyang.addCommands(genderInputCommands);actualCommandObj=genderInputCommands;console.log('Changed to "genderInputCommands"');break;case treatmentInputCommands:annyang.removeCommands(),annyang.addCommands(treatmentInputCommands),actualCommandObj=treatmentInputCommands,console.log('Changed to "treatmentInputCommands"')}}
function changeActualInput(a){actualInput=document.querySelector(a)}browserName.match("Chrome")&&(browserName="Google Chrome");browserName.match("MSIE")&&(browserName="Internet Explorer");browserName.match("IEMobile")&&(browserName="Internet Explorer no Windows Phone");browserName.match("Firefox")&&(browserName="Mozilla Firefox");
var balloon={i:5,"int":!1,animation:function(a,c,b){$(userSubmitedText).removeClass().hide().show().removeClass("animated "+b).addClass("animated "+c).html(a);balloon.i=5;var e=window.setInterval(function(){0<balloon.i&&--balloon.i;0===balloon.i&&$(userSubmitedText).is(":visible")&&(window.clearInterval(e),$(userSubmitedText).removeClass(c).addClass(b),balloon.i=5)},1E3);window.balloonInterval=e}};function rotina(){patterns();updt();voice();Reload();balloon.i=5}
function patterns(){uInput=actualInput.value;for(var a in brain)if(regex=new RegExp(brain[a][0],"i"),regex.test(uInput)){leng=brain[a].length-1;index=Math.ceil(leng*Math.random());reply=brain[a][index];sOutput=uInput.replace(regex,reply);sOutput=capitalize_s(sOutput);break}}function sophiaIni(){updt()}function updt(){ai.animation(sOutput,"fadeInUp","fadeOut");balloon.animation(uInput,"fadeInUp","fadeOutDown");actualInput.value=""}document.body.onunload=function(){speechSynthesis.cancel(_spRec_)};
function Reload(){$("#brain-arr-script").remove();var a=document.createElement("script");a.id="brain-arr-script";a.src="js/sophia.js";document.body.appendChild(a);console.log("arrays atualizadas")};
